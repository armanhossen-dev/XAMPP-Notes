<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.ChoiceBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.PasswordField?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.shape.SVGPath?>
<?import javafx.scene.text.Font?>

<AnchorPane prefHeight="900.0" prefWidth="1100.0" styleClass="root" xmlns="http://javafx.com/javafx/24.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.loginwithdatabase.EnhancedRegistrationForm">

    <!-- Main Content Container -->
    <VBox alignment="CENTER" layoutX="150.0" layoutY="25.0" prefHeight="850.0" prefWidth="800.0" AnchorPane.bottomAnchor="25.0" AnchorPane.leftAnchor="150.0" AnchorPane.rightAnchor="150.0" AnchorPane.topAnchor="25.0">

        <!-- Registration Card with ScrollPane -->
        <ScrollPane fitToWidth="true" hbarPolicy="NEVER" style="-fx-background-color: transparent; -fx-background: transparent;" vbarPolicy="AS_NEEDED">

            <VBox alignment="TOP_CENTER" prefWidth="780.0" spacing="28.0" styleClass="vbox-card">
                <padding>
                    <Insets bottom="32.0" left="40.0" right="40.0" top="32.0" />
                </padding>

                <!-- Header Section with Enhanced Styling -->
                <VBox alignment="CENTER" spacing="12.0">
                    <Label styleClass="header-title" text="Create Your Account">
                        <font>
                            <Font name="System Bold" size="32.0" />
                        </font>
                    </Label>
                    <Label styleClass="header-subtitle" text="Join our platform and start your journey today">
                        <font>
                            <Font size="16.0" />
                        </font>
                    </Label>
                    <!-- Visual separator -->
                    <Separator prefWidth="200.0" styleClass="header-separator">
                        <VBox.margin>
                            <Insets top="8.0" />
                        </VBox.margin>
                    </Separator>
                </VBox>

                <!-- User Type Selection with Enhanced Design -->
                <VBox spacing="8.0" styleClass="section-container">
                    <Label styleClass="section-header" text="Account Type">
                        <font>
                            <Font name="System Bold" size="16.0" />
                        </font>
                    </Label>
                    <ChoiceBox fx:id="userTypeChoiceBox" prefHeight="45.0" styleClass="enhanced-choice-box" />
                    <Label style="-fx-font-size: 12px; -fx-opacity: 0.7;" styleClass="help-text" text="Choose the type that best describes your role" />
                </VBox>

                <!-- Personal Information Section -->
                <VBox spacing="18.0" styleClass="section-container">
                    <HBox alignment="CENTER_LEFT" spacing="8.0">
                        <SVGPath content="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" scaleX="0.7" scaleY="0.7" styleClass="section-icon" />
                        <Label styleClass="section-header" text="Personal Information">
                            <font>
                                <Font name="System Bold" size="16.0" />
                            </font>
                        </Label>
                    </HBox>

                    <!-- Name and Phone Fields -->
                    <HBox spacing="16.0">
                        <VBox spacing="8.0" HBox.hgrow="ALWAYS">
                            <Label styleClass="field-label" text="Full Name *">
                                <font>
                                    <Font size="14.0" />
                                </font>
                            </Label>
                            <TextField fx:id="nameField" prefHeight="45.0" promptText="Enter your full name" styleClass="enhanced-text-field" />
                        </VBox>
                        <VBox spacing="8.0" HBox.hgrow="ALWAYS">
                            <Label styleClass="field-label" text="Phone Number *">
                                <font>
                                    <Font size="14.0" />
                                </font>
                            </Label>
                            <TextField fx:id="phoneField" prefHeight="45.0" promptText="e.g., +1 (555) 123-4567" styleClass="enhanced-text-field" />
                        </VBox>
                    </HBox>

                    <!-- Email Field -->
                    <VBox spacing="8.0">
                        <Label styleClass="field-label" text="Email Address *">
                            <font>
                                <Font size="14.0" />
                            </font>
                        </Label>
                        <TextField fx:id="emailField" prefHeight="45.0" promptText="Enter your email address" styleClass="enhanced-text-field" />
                    </VBox>
                </VBox>

                <!-- Account Credentials Section -->
                <VBox spacing="18.0" styleClass="section-container">
                    <HBox alignment="CENTER_LEFT" spacing="8.0">
                        <SVGPath content="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM12 17c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zM15.1 8H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z" scaleX="0.7" scaleY="0.7" styleClass="section-icon" />
                        <Label styleClass="section-header" text="Account Credentials">
                            <font>
                                <Font name="System Bold" size="16.0" />
                            </font>
                        </Label>
                    </HBox>

                    <!-- Username Field -->
                    <VBox spacing="8.0">
                        <Label styleClass="field-label" text="Username *">
                            <font>
                                <Font size="14.0" />
                            </font>
                        </Label>
                        <TextField fx:id="usernameField" prefHeight="45.0" promptText="Choose a unique username" styleClass="enhanced-text-field" />
                        <Label fx:id="usernameAvailability" style="-fx-font-size: 12px;" styleClass="help-text" text="Username availability will be checked" />
                    </VBox>

                    <!-- Password Fields -->
                    <HBox spacing="16.0">
                        <VBox spacing="8.0" HBox.hgrow="ALWAYS">
                            <HBox alignment="CENTER_LEFT" spacing="8.0">
                                <Label styleClass="field-label" text="Password *">
                                    <font>
                                        <Font size="14.0" />
                                    </font>
                                </Label>
                                <Region HBox.hgrow="ALWAYS" />
                                <Label style="-fx-font-size: 11px; -fx-opacity: 0.8;" styleClass="requirement-text" text="Min 8 characters" />
                            </HBox>

                            <StackPane prefHeight="45.0">
                                <PasswordField fx:id="passwordField" promptText="Create a strong password" styleClass="enhanced-password-field" />
                                <TextField fx:id="visiblePasswordField" managed="false" promptText="Create a strong password" styleClass="enhanced-text-field" visible="false" />

                                <HBox alignment="CENTER_RIGHT" mouseTransparent="true" StackPane.alignment="CENTER_RIGHT">
                                    <Button fx:id="togglePasswordButton" mouseTransparent="false" onAction="#togglePasswordVisibility" styleClass="toggle-button">
                                        <graphic>
                                            <SVGPath fx:id="togglePasswordIcon" content="M12 4.5C7 4.5 2.73 7.61 0 12c2.73 4.39 7 7.5 12 7.5s9.27-3.11 12-7.5c-2.73-4.39-7-7.5-12-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z" scaleX="0.75" scaleY="0.75" styleClass="toggle-icon" />
                                        </graphic>
                                        <HBox.margin>
                                            <Insets right="12.0" />
                                        </HBox.margin>
                                    </Button>
                                </HBox>
                            </StackPane>
                        </VBox>

                        <VBox spacing="8.0" HBox.hgrow="ALWAYS">
                            <Label styleClass="field-label" text="Confirm Password *">
                                <font>
                                    <Font size="14.0" />
                                </font>
                            </Label>
                            <PasswordField fx:id="confirmPasswordField" prefHeight="45.0" promptText="Confirm your password" styleClass="enhanced-password-field" />
                            <Label fx:id="passwordMatchStatus" style="-fx-font-size: 12px;" styleClass="help-text" text="Passwords must match" />
                        </VBox>
                    </HBox>
                </VBox>

                <!-- Location Field (Conditional for Landlords) -->
                <VBox fx:id="locationSection" managed="false" spacing="18.0" styleClass="section-container" visible="false">
                    <HBox alignment="CENTER_LEFT" spacing="8.0">
                        <SVGPath content="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" scaleX="0.7" scaleY="0.7" styleClass="section-icon" />
                        <Label styleClass="section-header" text="Property Information">
                            <font>
                                <Font name="System Bold" size="16.0" />
                            </font>
                        </Label>
                    </HBox>

                    <VBox spacing="8.0">
                        <Label styleClass="field-label" text="Property Location *">
                            <font>
                                <Font size="14.0" />
                            </font>
                        </Label>
                        <TextField fx:id="locationField" prefHeight="45.0" promptText="Enter your property address or area" styleClass="enhanced-text-field" />
                        <Label style="-fx-font-size: 12px; -fx-opacity: 0.7;" styleClass="help-text" text="This helps tenants find properties in their preferred area" />
                    </VBox>

                    <VBox spacing="8.0">
                        <Label styleClass="field-label" text="Property Description (Optional)">
                            <font>
                                <Font size="14.0" />
                            </font>
                        </Label>
                        <TextArea fx:id="propertyDescriptionField" prefRowCount="3" promptText="Brief description of your property..." styleClass="enhanced-text-area" wrapText="true" />
                    </VBox>
                </VBox>

                <!-- Terms and Conditions -->
                <VBox spacing="16.0" styleClass="section-container">
                    <CheckBox fx:id="termsCheckBox" styleClass="enhanced-checkbox" text="I agree to the Terms of Service and Privacy Policy *">
                        <font>
                            <Font size="14.0" />
                        </font>
                    </CheckBox>
                    <CheckBox fx:id="newsletterCheckBox" selected="true" styleClass="enhanced-checkbox" text="I would like to receive updates and promotional emails">
                        <font>
                            <Font size="14.0" />
                        </font>
                    </CheckBox>
                </VBox>

                <!-- Action Buttons -->
                <VBox alignment="CENTER" spacing="16.0" styleClass="button-section">
                    <Button fx:id="registerButton" defaultButton="true" onAction="#handleRegistration" prefHeight="50.0" prefWidth="400.0" styleClass="primary-button" text="Create Account">
                        <font>
                            <Font name="System Bold" size="16.0" />
                        </font>
                    </Button>

                    <Button onAction="#switchToLogin" prefHeight="45.0" prefWidth="400.0" styleClass="secondary-button" text="Already have an account? Sign in">
                        <font>
                            <Font size="15.0" />
                        </font>
                    </Button>
                </VBox>

                <!-- Footer Information -->
                <VBox alignment="CENTER" spacing="8.0" styleClass="footer-section">
                    <Label style="-fx-font-size: 12px; -fx-opacity: 0.8;" styleClass="footer-text" text="By creating an account, you acknowledge that you have read and agree to our" />
                    <HBox alignment="CENTER" spacing="8.0">
                        <Button style="-fx-background-color: transparent; -fx-text-fill: #3b82f6; -fx-font-size: 12px; -fx-underline: true;" styleClass="link-button" text="Terms of Service" />
                        <Label style="-fx-font-size: 12px; -fx-opacity: 0.8;" styleClass="footer-text" text="and" />
                        <Button style="-fx-background-color: transparent; -fx-text-fill: #3b82f6; -fx-font-size: 12px; -fx-underline: true;" styleClass="link-button" text="Privacy Policy" />
                    </HBox>
                </VBox>

                <!-- Bottom Padding -->
                <Region prefHeight="32.0" />
            </VBox>
        </ScrollPane>
    </VBox>

    <!-- Side Decoration (Optional) -->
    <VBox alignment="CENTER" prefWidth="120.0" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.topAnchor="0.0" styleClass="side-decoration" />
    <VBox alignment="CENTER" prefWidth="120.0" AnchorPane.bottomAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0" styleClass="side-decoration" />

</AnchorPane>